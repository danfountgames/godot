godot_add_library(embree FOLDER thirdparty STATIC)
# [[[cog
#   import cog
#   from cmake_builders import list_files
#   cog.outl('target_sources(embree PRIVATE')
#   for file in list_files(cog, ['common', 'kernels', 'include', 'patches'], recursive=True):
#       cog.outl(f'        {file}')
#   cog.outl(')')
# ]]]
target_sources(embree PRIVATE
        common/algorithms/parallel_any_of.h
        common/algorithms/parallel_filter.h
        common/algorithms/parallel_for.h
        common/algorithms/parallel_for_for.h
        common/algorithms/parallel_for_for_prefix_sum.h
        common/algorithms/parallel_map.h
        common/algorithms/parallel_partition.h
        common/algorithms/parallel_prefix_sum.h
        common/algorithms/parallel_reduce.h
        common/algorithms/parallel_set.h
        common/algorithms/parallel_sort.h
        common/lexers/parsestream.h
        common/lexers/stream.h
        common/lexers/streamfilters.h
        common/lexers/stringstream.cpp
        common/lexers/stringstream.h
        common/lexers/tokenstream.cpp
        common/lexers/tokenstream.h
        common/math/affinespace.h
        common/math/bbox.h
        common/math/col3.h
        common/math/col4.h
        common/math/color.h
        common/math/constants.cpp
        common/math/constants.h
        common/math/interval.h
        common/math/lbbox.h
        common/math/linearspace2.h
        common/math/linearspace3.h
        common/math/math.h
        common/math/obbox.h
        common/math/quaternion.h
        common/math/range.h
        common/math/transcendental.h
        common/math/vec2.h
        common/math/vec2fa.h
        common/math/vec3.h
        common/math/vec3ba.h
        common/math/vec3fa.h
        common/math/vec3ia.h
        common/math/vec4.h
        common/simd/arm/avx2neon.h
        common/simd/arm/emulation.h
        common/simd/arm/sse2neon.h
        common/simd/avx.h
        common/simd/avx512.h
        common/simd/simd.h
        common/simd/sse.cpp
        common/simd/sse.h
        common/simd/varying.h
        common/simd/vboold4_avx.h
        common/simd/vboold4_avx512.h
        common/simd/vboold8_avx512.h
        common/simd/vboolf16_avx512.h
        common/simd/vboolf4_avx512.h
        common/simd/vboolf4_sse2.h
        common/simd/vboolf8_avx.h
        common/simd/vboolf8_avx512.h
        common/simd/vdouble4_avx.h
        common/simd/vdouble8_avx512.h
        common/simd/vfloat16_avx512.h
        common/simd/vfloat4_sse2.h
        common/simd/vfloat8_avx.h
        common/simd/vint16_avx512.h
        common/simd/vint4_sse2.h
        common/simd/vint8_avx.h
        common/simd/vint8_avx2.h
        common/simd/vllong4_avx2.h
        common/simd/vllong8_avx512.h
        common/simd/vuint16_avx512.h
        common/simd/vuint4_sse2.h
        common/simd/vuint8_avx.h
        common/simd/vuint8_avx2.h
        common/simd/wasm/emulation.h
        common/sys/alloc.cpp
        common/sys/alloc.h
        common/sys/array.h
        common/sys/atomic.h
        common/sys/barrier.cpp
        common/sys/barrier.h
        common/sys/condition.cpp
        common/sys/condition.h
        common/sys/filename.cpp
        common/sys/filename.h
        common/sys/intrinsics.h
        common/sys/library.cpp
        common/sys/library.h
        common/sys/mutex.cpp
        common/sys/mutex.h
        common/sys/platform.h
        common/sys/ref.h
        common/sys/regression.cpp
        common/sys/regression.h
        common/sys/string.cpp
        common/sys/string.h
        common/sys/sysinfo.cpp
        common/sys/sysinfo.h
        common/sys/thread.cpp
        common/sys/thread.h
        common/sys/vector.h
        common/tasking/taskscheduler.h
        common/tasking/taskschedulerinternal.cpp
        common/tasking/taskschedulerinternal.h
        common/tasking/taskschedulerppl.h
        common/tasking/taskschedulertbb.h
        include/embree3/rtcore.h
        include/embree3/rtcore_buffer.h
        include/embree3/rtcore_builder.h
        include/embree3/rtcore_common.h
        include/embree3/rtcore_config.h
        include/embree3/rtcore_device.h
        include/embree3/rtcore_geometry.h
        include/embree3/rtcore_quaternion.h
        include/embree3/rtcore_ray.h
        include/embree3/rtcore_scene.h
        kernels/builders/bvh_builder_hair.h
        kernels/builders/bvh_builder_morton.h
        kernels/builders/bvh_builder_msmblur.h
        kernels/builders/bvh_builder_msmblur_hair.h
        kernels/builders/bvh_builder_sah.h
        kernels/builders/heuristic_binning.h
        kernels/builders/heuristic_binning_array_aligned.h
        kernels/builders/heuristic_binning_array_unaligned.h
        kernels/builders/heuristic_openmerge_array.h
        kernels/builders/heuristic_spatial.h
        kernels/builders/heuristic_spatial_array.h
        kernels/builders/heuristic_strand_array.h
        kernels/builders/heuristic_timesplit_array.h
        kernels/builders/priminfo.h
        kernels/builders/primrefgen.cpp
        kernels/builders/primrefgen.h
        kernels/builders/primrefgen_presplit.h
        kernels/builders/splitter.h
        kernels/bvh/bvh.cpp
        kernels/bvh/bvh.h
        kernels/bvh/bvh4_factory.cpp
        kernels/bvh/bvh4_factory.h
        kernels/bvh/bvh8_factory.cpp
        kernels/bvh/bvh8_factory.h
        kernels/bvh/bvh_builder.cpp
        kernels/bvh/bvh_builder.h
        kernels/bvh/bvh_builder_morton.cpp
        kernels/bvh/bvh_builder_sah.cpp
        kernels/bvh/bvh_builder_sah_mb.cpp
        kernels/bvh/bvh_builder_sah_spatial.cpp
        kernels/bvh/bvh_builder_twolevel.cpp
        kernels/bvh/bvh_builder_twolevel.h
        kernels/bvh/bvh_builder_twolevel_internal.h
        kernels/bvh/bvh_collider.cpp
        kernels/bvh/bvh_collider.h
        kernels/bvh/bvh_factory.h
        kernels/bvh/bvh_intersector1.cpp
        kernels/bvh/bvh_intersector1.h
        kernels/bvh/bvh_intersector1_bvh4.cpp
        kernels/bvh/bvh_intersector_hybrid.cpp
        kernels/bvh/bvh_intersector_hybrid.h
        kernels/bvh/bvh_intersector_hybrid4_bvh4.cpp
        kernels/bvh/bvh_intersector_stream.cpp
        kernels/bvh/bvh_intersector_stream.h
        kernels/bvh/bvh_intersector_stream_bvh4.cpp
        kernels/bvh/bvh_intersector_stream_filters.cpp
        kernels/bvh/bvh_intersector_stream_filters.h
        kernels/bvh/bvh_node_aabb.h
        kernels/bvh/bvh_node_aabb_mb.h
        kernels/bvh/bvh_node_aabb_mb4d.h
        kernels/bvh/bvh_node_base.h
        kernels/bvh/bvh_node_obb.h
        kernels/bvh/bvh_node_obb_mb.h
        kernels/bvh/bvh_node_qaabb.h
        kernels/bvh/bvh_node_ref.h
        kernels/bvh/bvh_refit.cpp
        kernels/bvh/bvh_refit.h
        kernels/bvh/bvh_rotate.cpp
        kernels/bvh/bvh_rotate.h
        kernels/bvh/bvh_statistics.cpp
        kernels/bvh/bvh_statistics.h
        kernels/bvh/bvh_traverser1.h
        kernels/bvh/bvh_traverser_stream.h
        kernels/bvh/node_intersector.h
        kernels/bvh/node_intersector1.h
        kernels/bvh/node_intersector_frustum.h
        kernels/bvh/node_intersector_packet.h
        kernels/bvh/node_intersector_packet_stream.h
        kernels/common/accel.h
        kernels/common/accelinstance.h
        kernels/common/acceln.cpp
        kernels/common/acceln.h
        kernels/common/accelset.cpp
        kernels/common/accelset.h
        kernels/common/alloc.cpp
        kernels/common/alloc.h
        kernels/common/buffer.h
        kernels/common/builder.h
        kernels/common/context.h
        kernels/common/default.h
        kernels/common/device.cpp
        kernels/common/device.h
        kernels/common/geometry.cpp
        kernels/common/geometry.h
        kernels/common/hit.h
        kernels/common/instance_stack.h
        kernels/common/isa.h
        kernels/common/motion_derivative.h
        kernels/common/point_query.h
        kernels/common/primref.h
        kernels/common/primref_mb.h
        kernels/common/profile.h
        kernels/common/ray.h
        kernels/common/rtcore.cpp
        kernels/common/rtcore.h
        kernels/common/rtcore_builder.cpp
        kernels/common/scene.cpp
        kernels/common/scene.h
        kernels/common/scene_curves.h
        kernels/common/scene_grid_mesh.h
        kernels/common/scene_instance.h
        kernels/common/scene_line_segments.h
        kernels/common/scene_points.h
        kernels/common/scene_quad_mesh.h
        kernels/common/scene_subdiv_mesh.h
        kernels/common/scene_triangle_mesh.cpp
        kernels/common/scene_triangle_mesh.h
        kernels/common/scene_user_geometry.h
        kernels/common/stack_item.h
        kernels/common/stat.cpp
        kernels/common/stat.h
        kernels/common/state.cpp
        kernels/common/state.h
        kernels/common/vector.h
        kernels/config.h
        kernels/geometry/cone.h
        kernels/geometry/coneline_intersector.h
        kernels/geometry/conelinei_intersector.h
        kernels/geometry/curveNi.h
        kernels/geometry/curveNi_intersector.h
        kernels/geometry/curveNi_mb.h
        kernels/geometry/curveNi_mb_intersector.h
        kernels/geometry/curveNv.h
        kernels/geometry/curveNv_intersector.h
        kernels/geometry/curve_intersector.h
        kernels/geometry/curve_intersector_distance.h
        kernels/geometry/curve_intersector_oriented.h
        kernels/geometry/curve_intersector_precalculations.h
        kernels/geometry/curve_intersector_ribbon.h
        kernels/geometry/curve_intersector_sweep.h
        kernels/geometry/curve_intersector_virtual.h
        kernels/geometry/cylinder.h
        kernels/geometry/disc_intersector.h
        kernels/geometry/disci_intersector.h
        kernels/geometry/filter.h
        kernels/geometry/grid_intersector.h
        kernels/geometry/grid_soa.h
        kernels/geometry/grid_soa_intersector1.h
        kernels/geometry/grid_soa_intersector_packet.h
        kernels/geometry/instance.h
        kernels/geometry/instance_intersector.h
        kernels/geometry/intersector_epilog.h
        kernels/geometry/intersector_iterators.h
        kernels/geometry/line_intersector.h
        kernels/geometry/linei.h
        kernels/geometry/linei_intersector.h
        kernels/geometry/object.h
        kernels/geometry/object_intersector.h
        kernels/geometry/plane.h
        kernels/geometry/pointi.h
        kernels/geometry/primitive.h
        kernels/geometry/primitive4.cpp
        kernels/geometry/quad_intersector.h
        kernels/geometry/quad_intersector_moeller.h
        kernels/geometry/quad_intersector_pluecker.h
        kernels/geometry/quadi.h
        kernels/geometry/quadi_intersector.h
        kernels/geometry/quadv.h
        kernels/geometry/quadv_intersector.h
        kernels/geometry/roundline_intersector.h
        kernels/geometry/roundlinei_intersector.h
        kernels/geometry/sphere_intersector.h
        kernels/geometry/spherei_intersector.h
        kernels/geometry/subdivpatch1.h
        kernels/geometry/subdivpatch1_intersector.h
        kernels/geometry/subgrid.h
        kernels/geometry/subgrid_intersector.h
        kernels/geometry/subgrid_intersector_moeller.h
        kernels/geometry/subgrid_intersector_pluecker.h
        kernels/geometry/subgrid_mb_intersector.h
        kernels/geometry/triangle.h
        kernels/geometry/triangle_intersector.h
        kernels/geometry/triangle_intersector_moeller.h
        kernels/geometry/triangle_intersector_pluecker.h
        kernels/geometry/triangle_intersector_woop.h
        kernels/geometry/triangle_triangle_intersector.h
        kernels/geometry/trianglei.h
        kernels/geometry/trianglei_intersector.h
        kernels/geometry/trianglev.h
        kernels/geometry/trianglev_intersector.h
        kernels/geometry/trianglev_mb.h
        kernels/geometry/trianglev_mb_intersector.h
        kernels/hash.h
        kernels/subdiv/bezier_curve.h
        kernels/subdiv/bezier_patch.h
        kernels/subdiv/bilinear_patch.h
        kernels/subdiv/bspline_curve.h
        kernels/subdiv/bspline_patch.h
        kernels/subdiv/catmullclark_coefficients.h
        kernels/subdiv/catmullclark_patch.h
        kernels/subdiv/catmullclark_ring.h
        kernels/subdiv/catmullrom_curve.h
        kernels/subdiv/feature_adaptive_eval.h
        kernels/subdiv/feature_adaptive_eval_grid.h
        kernels/subdiv/feature_adaptive_eval_simd.h
        kernels/subdiv/gregory_patch.h
        kernels/subdiv/gregory_patch_dense.h
        kernels/subdiv/gridrange.h
        kernels/subdiv/half_edge.h
        kernels/subdiv/hermite_curve.h
        kernels/subdiv/linear_bezier_patch.h
        kernels/subdiv/patch.h
        kernels/subdiv/patch_eval.h
        kernels/subdiv/patch_eval_grid.h
        kernels/subdiv/patch_eval_simd.h
        kernels/subdiv/subdivpatch1base.h
        kernels/subdiv/tessellation.h
        kernels/subdiv/tessellation_cache.h
)
# [[[end]]]
target_compile_definitions(embree PRIVATE
                                  TASKING_INTERNAL=1
                                  EMBREE_TARGET_SSE2=1
                                  EMBREE_LOWEST_ISA=1
                                  #HACK Remove the ignore
                                  EMBREE_IGNORE_INVALID_RAYS=1
                                  __SSE2__
                                  __SSE__)
target_include_directories(embree PUBLIC include)
target_compile_options(embree PRIVATE $<IF:$<CXX_COMPILER_ID:MSVC>,/w,-w>)
